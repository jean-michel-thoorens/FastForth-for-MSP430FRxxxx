;connect  param3
testlink
if result=0 connect  param3

sendln '     $0A BASE ! ECHO STOP' ; blanks are to pass LPMx wake up time...

inputbox 'Send a File' 'Select File : ' param2

strcompare param4 'NOECHO'
if result = 0 then
    sendln 'NOECHO' ; set no echo from FastForth
    setecho 0       ; suppr. echo from Teraterm
    showtt 0
;    clearscreen 1
    sendfile inputstr 0
    showtt 1
    goto end
endif

strcompare param4 'HALF'
if result = 0 then
    sendln 'NOECHO'
    setecho 1       ; add echo from Teraterm
    showtt 0
;    clearscreen 1
    sendfile inputstr 0
    setecho 1
    showtt 1
    goto end
endif

; default mode = ECHO
    setecho 0       ; no echo from Teraterm
    showtt 0
;    clearscreen 1
    sendfile inputstr 0
    showtt 1

:end
end


; param1 = this macro
; param2 = file to send
; param3 = "/C"
; param4 = "ECHO" or "NOECHO" or "HALF" or nothing