;connect  param3
testlink
if result<1 connect  param3

inputbox 'Send this file to the MSP430FR target:' ' ' param2

uptime timestart


strcompare param4 'NOECHO'
if result = 0 then
    send 'NOECHO [DEFINED] STOP [IF] STOP [THEN] ' ; set no echo from FastForth
    setecho 0       ; suppr. echo from Teraterm
    showtt 0
    clearscreen 1
    sendfile inputstr 0
    showtt 1
    goto end
endif

strcompare param4 'HALF'
if result = 0 then
    send 'NOECHO [DEFINED] STOP [IF] STOP [THEN] ' ; set no echo from FastForth
    setecho 1
    showtt 0
    clearscreen 1
    sendfile inputstr 0
    setecho 1
    send #4
    showtt 1
    goto end
endif

; default mode = ECHO
    send 'ECHO [DEFINED] STOP [IF] STOP [THEN] '
    setecho 0       ; no echo from Teraterm
    showtt 0
    clearscreen 1
    sendfile inputstr 0
    showtt 1

:end


; do something...

uptime timeend
diff = timeend - timestart
sprintf2 resultat " %s download and execute: %d msec" param2 diff
messagebox resultat "teraterm.exe"

unlink
;end


; param1 = this macro
; param2 = file to send
; param3 = "/C"
; param4 = "ECHO" or "NOECHO" or "HALF" or nothing


